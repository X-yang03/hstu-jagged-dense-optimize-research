INFO:root:Rank 0: loading gin config from configs/ml-1m/hstu-sampled-softmax-n128-large-final.gin
INFO:root:cuda.matmul.allow_tf32: True
INFO:root:cudnn.allow_tf32: True
INFO:root:Training model on rank 0.
Initialize _item_emb.weight as truncated normal: torch.Size([3953, 50]) params
Skipping init for _embedding_module._item_emb.weight
Initialize _input_features_preproc._pos_emb.weight as xavier normal: torch.Size([211, 50]) params
Skipping init for _hstu._attention_layers.0._uvqk
Skipping init for _hstu._attention_layers.0._rel_attn_bias._ts_w
Skipping init for _hstu._attention_layers.0._rel_attn_bias._pos_w
Skipping init for _hstu._attention_layers.0._o.weight
Skipping init for _hstu._attention_layers.0._o.bias
Skipping init for _hstu._attention_layers.1._uvqk
Skipping init for _hstu._attention_layers.1._rel_attn_bias._ts_w
Skipping init for _hstu._attention_layers.1._rel_attn_bias._pos_w
Skipping init for _hstu._attention_layers.1._o.weight
Skipping init for _hstu._attention_layers.1._o.bias
Skipping init for _hstu._attention_layers.2._uvqk
Skipping init for _hstu._attention_layers.2._rel_attn_bias._ts_w
Skipping init for _hstu._attention_layers.2._rel_attn_bias._pos_w
Skipping init for _hstu._attention_layers.2._o.weight
Skipping init for _hstu._attention_layers.2._o.bias
Skipping init for _hstu._attention_layers.3._uvqk
Skipping init for _hstu._attention_layers.3._rel_attn_bias._ts_w
Skipping init for _hstu._attention_layers.3._rel_attn_bias._pos_w
Skipping init for _hstu._attention_layers.3._o.weight
Skipping init for _hstu._attention_layers.3._o.bias
Skipping init for _hstu._attention_layers.4._uvqk
Skipping init for _hstu._attention_layers.4._rel_attn_bias._ts_w
Skipping init for _hstu._attention_layers.4._rel_attn_bias._pos_w
Skipping init for _hstu._attention_layers.4._o.weight
Skipping init for _hstu._attention_layers.4._o.bias
Skipping init for _hstu._attention_layers.5._uvqk
Skipping init for _hstu._attention_layers.5._rel_attn_bias._ts_w
Skipping init for _hstu._attention_layers.5._rel_attn_bias._pos_w
Skipping init for _hstu._attention_layers.5._o.weight
Skipping init for _hstu._attention_layers.5._o.bias
Skipping init for _hstu._attention_layers.6._uvqk
Skipping init for _hstu._attention_layers.6._rel_attn_bias._ts_w
Skipping init for _hstu._attention_layers.6._rel_attn_bias._pos_w
Skipping init for _hstu._attention_layers.6._o.weight
Skipping init for _hstu._attention_layers.6._o.bias
Skipping init for _hstu._attention_layers.7._uvqk
Skipping init for _hstu._attention_layers.7._rel_attn_bias._ts_w
Skipping init for _hstu._attention_layers.7._rel_attn_bias._pos_w
Skipping init for _hstu._attention_layers.7._o.weight
Skipping init for _hstu._attention_layers.7._o.bias
INFO:root:Rank 0: writing logs to ./exps/ml-1m-l200/HSTU-b8-h2-dqk25-dv25-lsilud0.2-ad0.0_DotProduct_local-l2-eps1e-06_ssl-t0.05-n128-b32-lr0.001-wu0-wd0-2025-04-04
INFO:root:rank 0:  batch-stat (eval): iter 0 (epoch 0): NDCG@10 0.0000, HR@10 0.0000, HR@50 0.0000, MRR 0.0011 
INFO:root: rank: 0, batch-stat (train): step 0 (epoch 0 in 44.98s): 8.394240
INFO:root:rank 0:  batch-stat (eval): iter 100 (epoch 0): NDCG@10 0.0233, HR@10 0.0625, HR@50 0.1875, MRR 0.0186 
INFO:root: rank: 0, batch-stat (train): step 100 (epoch 0 in 27.36s): 3.768848
INFO:root:rank 0: eval @ epoch 0 in 47.02s: NDCG@10 0.0625, NDCG@50 0.1031, HR@10 0.1202, HR@50 0.3096, MRR 0.0567
INFO:root:rank 0:  batch-stat (eval): iter 200 (epoch 1): NDCG@10 0.1297, HR@10 0.2812, HR@50 0.4062, MRR 0.0925 
INFO:root: rank: 0, batch-stat (train): step 200 (epoch 1 in 46.46s): 3.142433
INFO:root:rank 0:  batch-stat (eval): iter 300 (epoch 1): NDCG@10 0.0111, HR@10 0.0312, HR@50 0.3750, MRR 0.0251 
INFO:root: rank: 0, batch-stat (train): step 300 (epoch 1 in 27.38s): 3.026209
INFO:root:rank 0: eval @ epoch 1 in 46.83s: NDCG@10 0.1122, NDCG@50 0.1673, HR@10 0.2066, HR@50 0.4568, MRR 0.0983
INFO:root:rank 0:  batch-stat (eval): iter 400 (epoch 2): NDCG@10 0.1460, HR@10 0.2812, HR@50 0.3750, MRR 0.1136 
INFO:root: rank: 0, batch-stat (train): step 400 (epoch 2 in 49.36s): 2.655076
INFO:root:rank 0:  batch-stat (eval): iter 500 (epoch 2): NDCG@10 0.1338, HR@10 0.2812, HR@50 0.5000, MRR 0.1106 
INFO:root: rank: 0, batch-stat (train): step 500 (epoch 2 in 27.25s): 2.694842
INFO:root:rank 0: eval @ epoch 2 in 46.84s: NDCG@10 0.1293, NDCG@50 0.1860, HR@10 0.2406, HR@50 0.4982, MRR 0.1107
INFO:root:rank 0:  batch-stat (eval): iter 600 (epoch 3): NDCG@10 0.2163, HR@10 0.4062, HR@50 0.4688, MRR 0.1647 
INFO:root: rank: 0, batch-stat (train): step 600 (epoch 3 in 52.93s): 2.465650
INFO:root:rank 0:  batch-stat (eval): iter 700 (epoch 3): NDCG@10 0.1790, HR@10 0.3438, HR@50 0.6562, MRR 0.1453 
INFO:root: rank: 0, batch-stat (train): step 700 (epoch 3 in 27.19s): 2.277472
INFO:root:rank 0: eval @ epoch 3 in 47.06s: NDCG@10 0.1394, NDCG@50 0.1986, HR@10 0.2546, HR@50 0.5228, MRR 0.1200
INFO:root:rank 0:  batch-stat (eval): iter 800 (epoch 4): NDCG@10 0.1336, HR@10 0.2500, HR@50 0.5625, MRR 0.1168 
INFO:root: rank: 0, batch-stat (train): step 800 (epoch 4 in 55.38s): 2.251272
INFO:root:rank 0:  batch-stat (eval): iter 900 (epoch 4): NDCG@10 0.1329, HR@10 0.3125, HR@50 0.6562, MRR 0.0945 
INFO:root: rank: 0, batch-stat (train): step 900 (epoch 4 in 27.25s): 2.404152
INFO:root:rank 0: eval @ epoch 4 in 47.32s: NDCG@10 0.1473, NDCG@50 0.2053, HR@10 0.2704, HR@50 0.5318, MRR 0.1254
INFO:root:rank 0:  batch-stat (eval): iter 1000 (epoch 5): NDCG@10 0.1731, HR@10 0.2812, HR@50 0.6562, MRR 0.1576 
INFO:root: rank: 0, batch-stat (train): step 1000 (epoch 5 in 58.63s): 2.301472
INFO:root:rank 0:  batch-stat (eval): iter 1100 (epoch 5): NDCG@10 0.1142, HR@10 0.1875, HR@50 0.3438, MRR 0.1024 
INFO:root: rank: 0, batch-stat (train): step 1100 (epoch 5 in 27.17s): 2.528904
INFO:root:rank 0: eval @ epoch 5 in 47.19s: NDCG@10 0.1518, NDCG@50 0.2120, HR@10 0.2780, HR@50 0.5493, MRR 0.1294
INFO:root:rank 0:  batch-stat (eval): iter 1200 (epoch 6): NDCG@10 0.1853, HR@10 0.4062, HR@50 0.6250, MRR 0.1308 
INFO:root: rank: 0, batch-stat (train): step 1200 (epoch 6 in 61.78s): 2.196568
INFO:root:rank 0:  batch-stat (eval): iter 1300 (epoch 6): NDCG@10 0.1040, HR@10 0.2188, HR@50 0.5312, MRR 0.0852 
INFO:root: rank: 0, batch-stat (train): step 1300 (epoch 6 in 27.50s): 2.562337
INFO:root:rank 0: eval @ epoch 6 in 47.01s: NDCG@10 0.1535, NDCG@50 0.2153, HR@10 0.2783, HR@50 0.5573, MRR 0.1315
INFO:root:rank 0:  batch-stat (eval): iter 1400 (epoch 7): NDCG@10 0.0912, HR@10 0.2500, HR@50 0.7500, MRR 0.0698 
INFO:root: rank: 0, batch-stat (train): step 1400 (epoch 7 in 65.47s): 2.178750
INFO:root:rank 0:  batch-stat (eval): iter 1500 (epoch 7): NDCG@10 0.2411, HR@10 0.4375, HR@50 0.7188, MRR 0.1970 
INFO:root: rank: 0, batch-stat (train): step 1500 (epoch 7 in 27.45s): 2.408824
INFO:root:rank 0: eval @ epoch 7 in 47.46s: NDCG@10 0.1599, NDCG@50 0.2205, HR@10 0.2892, HR@50 0.5623, MRR 0.1363
INFO:root:rank 0:  batch-stat (eval): iter 1600 (epoch 8): NDCG@10 0.1135, HR@10 0.2188, HR@50 0.5938, MRR 0.1011 
INFO:root: rank: 0, batch-stat (train): step 1600 (epoch 8 in 67.55s): 2.203501
INFO:root:rank 0:  batch-stat (eval): iter 1700 (epoch 8): NDCG@10 0.1842, HR@10 0.3750, HR@50 0.5833, MRR 0.1397 
INFO:root: rank: 0, batch-stat (train): step 1700 (epoch 8 in 27.35s): 2.281414
INFO:root:rank 0: eval @ epoch 8 in 47.02s: NDCG@10 0.1646, NDCG@50 0.2259, HR@10 0.2945, HR@50 0.5709, MRR 0.1409
INFO:root:rank 0:  batch-stat (eval): iter 1800 (epoch 9): NDCG@10 0.1632, HR@10 0.3750, HR@50 0.6562, MRR 0.1135 
INFO:root: rank: 0, batch-stat (train): step 1800 (epoch 9 in 70.78s): 2.111656
INFO:root:rank 0: eval @ epoch 9 in 47.25s: NDCG@10 0.1628, NDCG@50 0.2230, HR@10 0.2970, HR@50 0.5689, MRR 0.1377
INFO:root:rank 0:  batch-stat (eval): iter 1900 (epoch 10): NDCG@10 0.2085, HR@10 0.4062, HR@50 0.7188, MRR 0.1621 
INFO:root: rank: 0, batch-stat (train): step 1900 (epoch 10 in 47.04s): 1.957751
INFO:root:rank 0:  batch-stat (eval): iter 2000 (epoch 10): NDCG@10 0.2812, HR@10 0.4062, HR@50 0.7188, MRR 0.2601 
INFO:root: rank: 0, batch-stat (train): step 2000 (epoch 10 in 27.40s): 2.031700
INFO:root:rank 0: eval @ epoch 10 in 47.07s: NDCG@10 0.1666, NDCG@50 0.2278, HR@10 0.2964, HR@50 0.5707, MRR 0.1432
INFO:root:rank 0:  batch-stat (eval): iter 2100 (epoch 11): NDCG@10 0.1916, HR@10 0.3125, HR@50 0.5938, MRR 0.1730 
INFO:root: rank: 0, batch-stat (train): step 2100 (epoch 11 in 49.19s): 2.382387
INFO:root:rank 0:  batch-stat (eval): iter 2200 (epoch 11): NDCG@10 0.1840, HR@10 0.3750, HR@50 0.6875, MRR 0.1426 
INFO:root: rank: 0, batch-stat (train): step 2200 (epoch 11 in 27.79s): 2.327389
INFO:root:rank 0: eval @ epoch 11 in 47.00s: NDCG@10 0.1724, NDCG@50 0.2311, HR@10 0.3086, HR@50 0.5719, MRR 0.1466
INFO:root:rank 0:  batch-stat (eval): iter 2300 (epoch 12): NDCG@10 0.2219, HR@10 0.4062, HR@50 0.7188, MRR 0.1853 
INFO:root: rank: 0, batch-stat (train): step 2300 (epoch 12 in 52.53s): 2.007538
INFO:root:rank 0:  batch-stat (eval): iter 2400 (epoch 12): NDCG@10 0.1591, HR@10 0.3438, HR@50 0.5312, MRR 0.1162 
INFO:root: rank: 0, batch-stat (train): step 2400 (epoch 12 in 27.73s): 2.142376
INFO:root:rank 0: eval @ epoch 12 in 47.23s: NDCG@10 0.1702, NDCG@50 0.2294, HR@10 0.3088, HR@50 0.5747, MRR 0.1435
INFO:root:rank 0:  batch-stat (eval): iter 2500 (epoch 13): NDCG@10 0.1779, HR@10 0.4062, HR@50 0.6562, MRR 0.1231 
INFO:root: rank: 0, batch-stat (train): step 2500 (epoch 13 in 55.40s): 2.345936
INFO:root:rank 0:  batch-stat (eval): iter 2600 (epoch 13): NDCG@10 0.1268, HR@10 0.2812, HR@50 0.6250, MRR 0.0992 
INFO:root: rank: 0, batch-stat (train): step 2600 (epoch 13 in 26.36s): 2.093476
INFO:root:rank 0: eval @ epoch 13 in 47.09s: NDCG@10 0.1722, NDCG@50 0.2332, HR@10 0.3109, HR@50 0.5871, MRR 0.1455
INFO:root:rank 0:  batch-stat (eval): iter 2700 (epoch 14): NDCG@10 0.1599, HR@10 0.3438, HR@50 0.5938, MRR 0.1154 
INFO:root: rank: 0, batch-stat (train): step 2700 (epoch 14 in 58.04s): 2.120182
INFO:root:rank 0:  batch-stat (eval): iter 2800 (epoch 14): NDCG@10 0.1861, HR@10 0.2812, HR@50 0.6250, MRR 0.1727 
INFO:root: rank: 0, batch-stat (train): step 2800 (epoch 14 in 27.52s): 2.289569
INFO:root:rank 0: eval @ epoch 14 in 47.02s: NDCG@10 0.1736, NDCG@50 0.2335, HR@10 0.3116, HR@50 0.5811, MRR 0.1473
INFO:root:rank 0:  batch-stat (eval): iter 2900 (epoch 15): NDCG@10 0.2421, HR@10 0.4062, HR@50 0.7188, MRR 0.2062 
INFO:root: rank: 0, batch-stat (train): step 2900 (epoch 15 in 61.08s): 1.986035
INFO:root:rank 0:  batch-stat (eval): iter 3000 (epoch 15): NDCG@10 0.2510, HR@10 0.4375, HR@50 0.7188, MRR 0.2102 
INFO:root: rank: 0, batch-stat (train): step 3000 (epoch 15 in 27.29s): 2.172523
INFO:root:rank 0: eval @ epoch 15 in 47.03s: NDCG@10 0.1749, NDCG@50 0.2348, HR@10 0.3096, HR@50 0.5791, MRR 0.1497
INFO:root:rank 0:  batch-stat (eval): iter 3100 (epoch 16): NDCG@10 0.1931, HR@10 0.3125, HR@50 0.6875, MRR 0.1775 
INFO:root: rank: 0, batch-stat (train): step 3100 (epoch 16 in 64.51s): 2.098208
INFO:root:rank 0:  batch-stat (eval): iter 3200 (epoch 16): NDCG@10 0.1165, HR@10 0.2500, HR@50 0.5938, MRR 0.0938 
INFO:root: rank: 0, batch-stat (train): step 3200 (epoch 16 in 27.73s): 2.131458
INFO:root:rank 0: eval @ epoch 16 in 46.78s: NDCG@10 0.1738, NDCG@50 0.2341, HR@10 0.3081, HR@50 0.5793, MRR 0.1487
INFO:root:rank 0:  batch-stat (eval): iter 3300 (epoch 17): NDCG@10 0.2032, HR@10 0.3438, HR@50 0.5938, MRR 0.1787 
INFO:root: rank: 0, batch-stat (train): step 3300 (epoch 17 in 67.67s): 2.148609
INFO:root:rank 0:  batch-stat (eval): iter 3400 (epoch 17): NDCG@10 0.1645, HR@10 0.3438, HR@50 0.6562, MRR 0.1293 
INFO:root: rank: 0, batch-stat (train): step 3400 (epoch 17 in 27.14s): 2.020714
INFO:root:rank 0: eval @ epoch 17 in 46.85s: NDCG@10 0.1786, NDCG@50 0.2393, HR@10 0.3123, HR@50 0.5848, MRR 0.1538
INFO:root:rank 0:  batch-stat (eval): iter 3500 (epoch 18): NDCG@10 0.2862, HR@10 0.4062, HR@50 0.6562, MRR 0.2636 
INFO:root: rank: 0, batch-stat (train): step 3500 (epoch 18 in 69.43s): 2.119084
INFO:root:rank 0: eval @ epoch 18 in 46.98s: NDCG@10 0.1818, NDCG@50 0.2397, HR@10 0.3235, HR@50 0.5844, MRR 0.1538
INFO:root:rank 0:  batch-stat (eval): iter 3600 (epoch 19): NDCG@10 0.2518, HR@10 0.3750, HR@50 0.7500, MRR 0.2308 
INFO:root: rank: 0, batch-stat (train): step 3600 (epoch 19 in 46.08s): 2.117432
INFO:root:rank 0:  batch-stat (eval): iter 3700 (epoch 19): NDCG@10 0.2071, HR@10 0.3438, HR@50 0.6875, MRR 0.1834 
INFO:root: rank: 0, batch-stat (train): step 3700 (epoch 19 in 28.07s): 2.193659
INFO:root:rank 0: eval @ epoch 19 in 47.52s: NDCG@10 0.1777, NDCG@50 0.2368, HR@10 0.3161, HR@50 0.5829, MRR 0.1509
INFO:root:rank 0:  batch-stat (eval): iter 3800 (epoch 20): NDCG@10 0.2606, HR@10 0.4375, HR@50 0.7500, MRR 0.2274 
INFO:root: rank: 0, batch-stat (train): step 3800 (epoch 20 in 49.03s): 2.011676
INFO:root:rank 0:  batch-stat (eval): iter 3900 (epoch 20): NDCG@10 0.1592, HR@10 0.2812, HR@50 0.5625, MRR 0.1393 
INFO:root: rank: 0, batch-stat (train): step 3900 (epoch 20 in 27.38s): 1.975453
INFO:root:rank 0: eval @ epoch 20 in 47.27s: NDCG@10 0.1816, NDCG@50 0.2406, HR@10 0.3166, HR@50 0.5820, MRR 0.1558
